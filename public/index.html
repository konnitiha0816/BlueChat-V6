<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlueChat V3</title>
    <link href="https://fonts.googleapis.com/css2?family=Lexend+Exa:wght@700&display=swap" rel="stylesheet">
    <style>
        /* --- åŸºæœ¬è¨­å®š & æ˜¼å¤œèƒŒæ™¯ --- */
        body { margin: 0; font-family: sans-serif; overflow: hidden; color: white; transition: background 2s; }
        .day-bg { background: linear-gradient(#4facfe, #00f2fe); }
        .night-bg { background: linear-gradient(#09203f, #537895); }
        .hidden { display: none !important; }
        .v3-tag { position: absolute; top: 10px; right: 10px; font-weight: bold; }
        
        /* --- ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ --- */
        .full-screen { height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .glass { background: rgba(0,0,0,0.5); padding: 30px; border-radius: 20px; backdrop-filter: blur(10px); width: 300px; }
        .title-text { font-family: 'Lexend Exa', sans-serif; font-size: 60px; text-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        input { width: 90%; padding: 10px; margin: 10px 0; border-radius: 5px; border: none; }
        button { cursor: pointer; padding: 10px 20px; border-radius: 20px; border: none; font-weight: bold; }
        .btn-blue { background: #0078d4; color: white; width: 100%; }
        
        /* --- é€šè©±ç”»é¢ --- */
        #screen-call { height: 100vh; background: #202124; position: relative; }
        video { width: 100%; height: 100%; object-fit: cover; }
        .controls { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 10px; background: rgba(0,0,0,0.6); padding: 10px; border-radius: 50px; }
        .icon-btn { width: 45px; height: 45px; border-radius: 50%; font-size: 20px; background: #3c4043; color: white; display:flex; align-items:center; justify-content:center; }
        .red { background: #ea4335; }
        
        /* --- ã‚µã‚¤ãƒ‰ãƒãƒ¼ --- */
        .sidebar { position: fixed; right: 0; top: 0; width: 300px; height: 100%; background: white; color: black; transform: translateX(300px); transition: 0.3s; padding: 20px; box-sizing: border-box; }
        .open { transform: translateX(0); }
    </style>
</head>
<body class="day-bg">
    <div class="v3-tag">V3</div>

    <div id="screen-start" class="full-screen" style="z-index: 999; background: rgba(0,0,0,0.8);">
        <h1>Click to Start</h1>
        <p>ç”»é¢ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦èµ·å‹•ã—ã¦ãã ã•ã„</p>
    </div>

    <div id="screen-title" class="full-screen hidden">
        <div class="title-text">Blue Chat</div>
        <br>
        <button onclick="startCaptcha()" style="font-size: 20px; padding: 15px 50px;">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
    </div>

    <div id="screen-captcha" class="full-screen hidden">
        <div class="glass">
            <h3>ğŸ¤– ãƒ­ãƒœãƒƒãƒˆèªè¨¼</h3>
            <h2 id="kuku-q"></h2>
            <input type="number" id="kuku-a" placeholder="ç­”ãˆ">
            <button class="btn-blue" onclick="checkCaptcha()">ç¢ºèª</button>
        </div>
    </div>

    <div id="screen-nick" class="full-screen hidden">
        <div class="glass">
            <h3>ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ è¨­å®š</h3>
            <input type="text" id="my-nick" placeholder="è¡¨ç¤ºå">
            <p style="font-size:10px; color:#ffaaaa;">â€»æœ¬åç¦æ­¢</p>
            <button class="btn-blue" onclick="setNick()">æ±ºå®š</button>
        </div>
    </div>

    <div id="screen-menu" class="full-screen hidden">
        <div class="glass">
            <button class="btn-blue" onclick="showJoin()" style="margin-bottom:10px;">é€šè©±</button>
            <button class="btn-blue" style="background:#888;" onclick="alert('ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ä¸­')">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</button>
        </div>
    </div>

    <div id="screen-join" class="full-screen hidden">
        <div class="glass">
            <h3>é€šè©±ã«å‚åŠ  / ä½œæˆ</h3>
            <input type="text" id="room-id" placeholder="é€šè©±ID (6æ–‡å­—)">
            <button class="btn-blue" onclick="joinRoom()">å‚åŠ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</button>
            <br><br>
            <button onclick="createRoom()" style="background:green; color:white; width:100%;">æ–°ã—ãé€šè©±ã‚’ä½œã‚‹</button>
        </div>
    </div>

    <div id="screen-wait" class="full-screen hidden">
        <h2>ä¸»å‚¬è€…ã®æ‰¿èªå¾…ã¡...</h2>
        <p>â™ª éŸ³æ¥½ãŒæµã‚Œã¦ã„ã¾ã™</p>
    </div>

    <div id="screen-call" class="hidden">
        <div style="position:absolute; top:10px; left:10px; z-index:10;">Blue Chat</div>
        <video id="main-video" autoplay playsinline></video>
        <div style="position:absolute; bottom:80px; left:20px; text-shadow:2px 2px 2px black;">
            <div id="clock">00:00</div>
            <div id="disp-id">ID: ---</div>
        </div>
        
        <div class="controls">
            <button class="icon-btn">ğŸ¤</button>
            <button class="icon-btn">ğŸ“·</button>
            <button class="icon-btn">ğŸ“¤</button>
            <button class="icon-btn">âœ‹</button>
            <button class="icon-btn" onclick="toggleSidebar('chat')">ğŸ’¬</button>
            <button class="icon-btn" onclick="toggleSidebar('admin')">âš™ï¸</button>
            <button class="icon-btn red" onclick="location.reload()">ğŸ“</button>
        </div>

        <div id="side-chat" class="sidebar">
            <h3>ãƒãƒ£ãƒƒãƒˆ</h3>
            <div id="chat-box" style="height:80%; overflow-y:auto;"></div>
            <input type="text" id="chat-in" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸">
            <button class="btn-blue" onclick="sendChat()">é€ä¿¡</button>
        </div>
        
        <div id="side-admin" class="sidebar">
            <h3>ç®¡ç†è¨­å®š</h3>
            <button class="btn-blue" onclick="adminAction('lock')">é€šè©±ãƒ­ãƒƒã‚¯åˆ‡æ›¿</button>
            <br><br>
            <button class="btn-blue" style="background:red;" onclick="adminAction('kick-all')">å…¨å“¡å¼·åˆ¶é€€å‡º</button>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="client.js"></script>
</body>
</html>
